# =============================================================================
# SECURITY CONFIGURATION TEMPLATE
# =============================================================================
# Copy this file to .env and fill in your actual values
# NEVER commit the actual .env file to version control
# Run: python scripts/validate_security.py to validate your configuration

# =============================================================================
# CRITICAL SECURITY SETTINGS (REQUIRED FOR PRODUCTION)
# =============================================================================

# JWT Security (REQUIRED)
# Generate with: openssl rand -hex 32
# Must be at least 32 characters long
JWT_SECRET_KEY=

# Encryption Security (REQUIRED)
# Generate with: openssl rand -hex 32
# Used for encrypting sensitive data at rest
ENCRYPTION_MASTER_KEY=

# Generate with: openssl rand -hex 16
# Used for key derivation salt (environment-specific)
ENCRYPTION_SALT=

# Audit Security (REQUIRED)
# Generate with: openssl rand -hex 32
# Used for audit log integrity protection
AUDIT_CHECKSUM_SALT=

# =============================================================================
# API KEYS (REQUIRED)
# =============================================================================

# Gemini API Key (REQUIRED)
# Get from: https://makersuite.google.com/app/apikey
# Format: AIzaSy... (39 characters starting with AIza)
GEMINI_API_KEY=

# =============================================================================
# DATABASE SECURITY
# =============================================================================

# Database Connection (Secure Format)
# Use separate components instead of DATABASE_URL to avoid credential exposure
DB_HOST=localhost
DB_PORT=5432
DB_NAME=webscraper
DB_USER=scraper_user
DB_PASSWORD=  # Generate strong password: openssl rand -base64 32

# Database SSL Configuration
DB_SSL_MODE=require  # Options: disable, allow, prefer, require, verify-ca, verify-full
DB_ENCRYPT_SENSITIVE_FIELDS=true

# Connection Pool Settings
DB_POOL_SIZE=10
DB_MAX_OVERFLOW=20
DB_POOL_TIMEOUT=30

# =============================================================================
# REDIS SECURITY
# =============================================================================

# Redis Connection (Secure Format)
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=  # Generate strong password: openssl rand -base64 32

# Redis SSL Configuration (for production)
REDIS_SSL=false  # Set to true for production
REDIS_SSL_CERT_REQS=required
REDIS_SSL_CA_CERTS=/path/to/ca-certificates.crt

# =============================================================================
# API SECURITY
# =============================================================================

# CORS Configuration
# Use specific domains in production, avoid wildcards
CORS_ORIGINS=https://yourdomain.com,https://api.yourdomain.com

# Rate Limiting
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_BURST_SIZE=10

# Request Size Limits
MAX_REQUEST_SIZE_MB=10
MAX_URL_LENGTH=2048
MAX_HEADER_LENGTH=8192

# =============================================================================
# SESSION SECURITY
# =============================================================================

# Session Configuration
SESSION_TIMEOUT_MINUTES=30
SESSION_SECURE_COOKIES=true  # Requires HTTPS
SESSION_HTTPONLY_COOKIES=true
SESSION_SAMESITE=strict  # Options: strict, lax, none

# =============================================================================
# SCRAPING SECURITY
# =============================================================================

# User Agents (Generic to prevent fingerprinting)
# Avoid system-specific information (Windows versions, browser versions, etc.)
SCRAPER_USER_AGENTS="Mozilla/5.0 (compatible; WebScraper/1.0)|Mozilla/5.0 (compatible; DataCollector/1.0)|Mozilla/5.0 (compatible; ContentAnalyzer/1.0)"

# Scraping Behavior
SCRAPER_RESPECT_ROBOTS_TXT=true
SCRAPER_VALIDATE_SSL=true
SCRAPER_MAX_REDIRECTS=5
SCRAPER_REQUEST_DELAY_SECONDS=1.0
SCRAPER_MAX_CONCURRENT_REQUESTS=5

# Proxy Configuration (Optional)
# Use separate fields to avoid credential exposure in URLs
PROXY_ENABLED=false
PROXY_HOST=
PROXY_PORT=
PROXY_USERNAME=
PROXY_PASSWORD=
PROXY_PROTOCOL=http

# =============================================================================
# LOGGING SECURITY
# =============================================================================

# Log Configuration
LOG_LEVEL=INFO  # Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT=json  # Use JSON for structured logging
LOG_FILE=/var/log/webscraper/app.log

# Audit Logging
AUDIT_LOG_FILE=/var/log/webscraper/audit.log
AUDIT_LOG_MAX_SIZE_MB=100
AUDIT_LOG_BACKUP_COUNT=5

# =============================================================================
# DATA RETENTION POLICIES
# =============================================================================

# Retention Periods (in days)
RETENTION_SCRAPED_DATA_DAYS=365
RETENTION_JOB_LOGS_DAYS=90
RETENTION_SYSTEM_METRICS_DAYS=30
RETENTION_AUDIT_LOGS_DAYS=2555  # 7 years for compliance
RETENTION_USER_SESSIONS_DAYS=30

# Retention Settings
RETENTION_CLEANUP_BATCH_SIZE=1000
RETENTION_DRY_RUN=false

# =============================================================================
# CONTENT SECURITY POLICY
# =============================================================================

# CSP Directives
CSP_DEFAULT_SRC="'self'"
CSP_SCRIPT_SRC="'self' 'unsafe-inline'"
CSP_STYLE_SRC="'self' 'unsafe-inline'"
CSP_IMG_SRC="'self' data: https:"

# =============================================================================
# FILE SECURITY
# =============================================================================

# Secure Configuration Storage
SECURE_CONFIG_FILE=config/secure_config.enc

# File Upload Restrictions
FILE_UPLOAD_MAX_SIZE_MB=50
ALLOWED_FILE_EXTENSIONS=.txt,.csv,.json,.xml,.html

# =============================================================================
# ENVIRONMENT SETTINGS
# =============================================================================

# Environment Type
ENVIRONMENT=production  # Options: development, staging, production

# Debug Mode (NEVER enable in production)
DEBUG=false

# Application Settings
APP_NAME="AI Web Scraper"
API_HOST=0.0.0.0
API_PORT=8000
DASHBOARD_PORT=8501

# =============================================================================
# SECURITY VALIDATION CHECKLIST
# =============================================================================
# Before deploying to production, ensure:
#
# [ ] All required environment variables are set with secure values
# [ ] JWT_SECRET_KEY is at least 32 characters and randomly generated
# [ ] ENCRYPTION_MASTER_KEY is at least 32 characters and randomly generated
# [ ] All passwords are strong (12+ characters, mixed case, numbers, symbols)
# [ ] CORS_ORIGINS contains only your actual domains (no wildcards)
# [ ] Database SSL is enabled (DB_SSL_MODE=require)
# [ ] Redis SSL is enabled for production (REDIS_SSL=true)
# [ ] Session cookies are secure (SESSION_SECURE_COOKIES=true)
# [ ] Debug mode is disabled (DEBUG=false)
# [ ] Log level is appropriate (LOG_LEVEL=INFO or WARNING)
# [ ] File permissions are restrictive (chmod 600 .env)
# [ ] No hardcoded secrets in source code
# [ ] User agents are generic (no system-specific information)
# [ ] SSL validation is enabled (SCRAPER_VALIDATE_SSL=true)
# [ ] Robots.txt respect is enabled (SCRAPER_RESPECT_ROBOTS_TXT=true)
# [ ] Rate limiting is configured appropriately
# [ ] Data retention policies are set according to your requirements
#
# Run validation: python scripts/validate_security.py

# =============================================================================
# QUICK SETUP COMMANDS
# =============================================================================
# Generate all required secrets at once:
#
# JWT_SECRET_KEY=$(openssl rand -hex 32)
# ENCRYPTION_MASTER_KEY=$(openssl rand -hex 32)
# ENCRYPTION_SALT=$(openssl rand -hex 16)
# AUDIT_CHECKSUM_SALT=$(openssl rand -hex 32)
# DB_PASSWORD=$(openssl rand -base64 32)
# REDIS_PASSWORD=$(openssl rand -base64 32)
#
# Set file permissions:
# chmod 600 .env
#
# Validate configuration:
# python scripts/validate_security.py